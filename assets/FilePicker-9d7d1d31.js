import{r as ne,a as ie}from"./firebase_database-d5d358c6.js";import{h as R,T as De,a as Ee,b as J,w as D,_ as z,p as X,k as Z}from"./lightbox-778a0ebd.js";import{h as Pe,g as O,G as ae,i as Re,O as Me,o as C,I as T,j as oe,k as se,s as K,m as Ie,l as Be,n as ke,p as Oe,q as Fe,t as B,S as k,f as ce,v as le,w as Le,x as Te,y as He,z as V,A as $,B as Ue}from"./index-1d4b8e8e.js";import{a as Q,d as he}from"./firebase-7334874f.js";import{u as je,g as G,r as M,l as Qe,d as Ge}from"./firebase_storage-5d4e80db.js";import"./firebase_app-5c6bc232.js";var ue={exports:{}};(function(a){(function(n){var r=n.URL||n.webkitURL;function o(e){return r?r.createObjectURL(e):!1}function t(e){return r?r.revokeObjectURL(e):!1}function l(e,i){e&&e.slice(0,5)==="blob:"&&!(i&&i.noRevoke)&&t(e)}function f(e,i,s,c){if(!n.FileReader)return!1;var h=new FileReader;h.onload=function(){i.call(h,this.result)},s&&(h.onabort=h.onerror=function(){s.call(h,this.error)});var x=h[c||"readAsDataURL"];if(x)return x.call(h,e),h}function d(e,i){return Object.prototype.toString.call(i)==="[object "+e+"]"}function g(e,i,s){function c(h,x){var u=document.createElement("img"),p;function m(v,b){if(h===x){h&&h(v,b);return}else if(v instanceof Error){x(v);return}b=b||{},b.image=v,h(b)}function w(v,b){b&&n.console&&console.log(b),v&&d("Blob",v)?(e=v,p=o(e)):(p=e,s&&s.crossOrigin&&(u.crossOrigin=s.crossOrigin)),u.src=p}if(u.onerror=function(v){l(p,s),x&&x.call(u,v)},u.onload=function(){l(p,s);var v={originalWidth:u.naturalWidth||u.width,originalHeight:u.naturalHeight||u.height};try{g.transform(u,s,m,e,v)}catch(b){x&&x(b)}},typeof e=="string")return g.requiresMetaData(s)?g.fetchBlob(e,w,s):w(),u;if(d("Blob",e)||d("File",e))return p=o(e),p?(u.src=p,u):f(e,function(v){u.src=v},x)}return n.Promise&&typeof i!="function"?(s=i,new Promise(c)):c(i,i)}g.requiresMetaData=function(e){return e&&e.meta},g.fetchBlob=function(e,i){i()},g.transform=function(e,i,s,c,h){s(e,h)},g.global=n,g.readFile=f,g.isInstanceOf=d,g.createObjectURL=o,g.revokeObjectURL=t,a.exports?a.exports=g:n.loadImage=g})(typeof window<"u"&&window||Pe)})(ue);var F=ue.exports;O(F);var de={exports:{}};(function(a){(function(n){a.exports?n(F):n(window.loadImage)})(function(n){var r=n.transform;n.createCanvas=function(o,t,l){if(l&&n.global.OffscreenCanvas)return new OffscreenCanvas(o,t);var f=document.createElement("canvas");return f.width=o,f.height=t,f},n.transform=function(o,t,l,f,d){r.call(n,n.scale(o,t,d),t,l,f,d)},n.transformCoordinates=function(){},n.getTransformedOptions=function(o,t){var l=t.aspectRatio,f,d,g,e;if(!l)return t;f={};for(d in t)Object.prototype.hasOwnProperty.call(t,d)&&(f[d]=t[d]);return f.crop=!0,g=o.naturalWidth||o.width,e=o.naturalHeight||o.height,g/e>l?(f.maxWidth=e*l,f.maxHeight=e):(f.maxWidth=g,f.maxHeight=g/l),f},n.drawImage=function(o,t,l,f,d,g,e,i,s){var c=t.getContext("2d");return s.imageSmoothingEnabled===!1?(c.msImageSmoothingEnabled=!1,c.imageSmoothingEnabled=!1):s.imageSmoothingQuality&&(c.imageSmoothingQuality=s.imageSmoothingQuality),c.drawImage(o,l,f,d,g,0,0,e,i),c},n.requiresCanvas=function(o){return o.canvas||o.crop||!!o.aspectRatio},n.scale=function(o,t,l){t=t||{},l=l||{};var f=o.getContext||n.requiresCanvas(t)&&!!n.global.HTMLCanvasElement,d=o.naturalWidth||o.width,g=o.naturalHeight||o.height,e=d,i=g,s,c,h,x,u,p,m,w,v,b,y,A;function S(){var P=Math.max((h||e)/e,(x||i)/i);P>1&&(e*=P,i*=P)}function E(){var P=Math.min((s||e)/e,(c||i)/i);P<1&&(e*=P,i*=P)}if(f&&(t=n.getTransformedOptions(o,t,l),m=t.left||0,w=t.top||0,t.sourceWidth?(u=t.sourceWidth,t.right!==void 0&&t.left===void 0&&(m=d-u-t.right)):u=d-m-(t.right||0),t.sourceHeight?(p=t.sourceHeight,t.bottom!==void 0&&t.top===void 0&&(w=g-p-t.bottom)):p=g-w-(t.bottom||0),e=u,i=p),s=t.maxWidth,c=t.maxHeight,h=t.minWidth,x=t.minHeight,f&&s&&c&&t.crop?(e=s,i=c,y=u/p-s/c,y<0?(p=c*u/s,t.top===void 0&&t.bottom===void 0&&(w=(g-p)/2)):y>0&&(u=s*p/c,t.left===void 0&&t.right===void 0&&(m=(d-u)/2))):((t.contain||t.cover)&&(h=s=s||h,x=c=c||x),t.cover?(E(),S()):(S(),E())),f){if(v=t.pixelRatio,v>1&&!(o.style.width&&Math.floor(parseFloat(o.style.width,10))===Math.floor(d/v))&&(e*=v,i*=v),n.orientationCropBug&&!o.getContext&&(m||w||u!==d||p!==g)&&(y=o,o=n.createCanvas(d,g,!0),n.drawImage(y,o,0,0,d,g,d,g,t)),b=t.downsamplingRatio,b>0&&b<1&&e<u&&i<p)for(;u*b>e;)A=n.createCanvas(u*b,p*b,!0),n.drawImage(o,A,m,w,u,p,A.width,A.height,t),m=0,w=0,u=A.width,p=A.height,o=A;return A=n.createCanvas(e,i),n.transformCoordinates(A,t,l),v>1&&(A.style.width=A.width/v+"px"),n.drawImage(o,A,m,w,u,p,e,i,t).setTransform(1,0,0,1,0,0),A}return o.width=e,o.height=i,o}})})(de);var fe=de.exports;O(fe);var ge={exports:{}};(function(a){(function(n){a.exports?n(F):n(window.loadImage)})(function(n){var r=n.global,o=n.transform,t=r.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),l=r.ArrayBuffer&&ArrayBuffer.prototype.slice||function(i,s){s=s||this.byteLength-i;var c=new Uint8Array(this,i,s),h=new Uint8Array(s);return h.set(c),h.buffer},f={jpeg:{65505:[],65517:[]}};function d(i,s,c,h){var x=this;function u(p,m){if(!(r.DataView&&t&&i&&i.size>=12&&i.type==="image/jpeg"))return p(h);var w=c.maxMetaDataSize||262144;n.readFile(t.call(i,0,w),function(v){var b=new DataView(v);if(b.getUint16(0)!==65496)return m(new Error("Invalid JPEG file: Missing JPEG marker."));for(var y=2,A=b.byteLength-4,S=y,E,P,N,_;y<A&&(E=b.getUint16(y),E>=65504&&E<=65519||E===65534);){if(P=b.getUint16(y+2)+2,y+P>b.byteLength){console.log("Invalid JPEG metadata: Invalid segment size.");break}if(N=f.jpeg[E],N&&!c.disableMetaDataParsers)for(_=0;_<N.length;_+=1)N[_].call(x,b,y,P,h,c);y+=P,S=y}!c.disableImageHead&&S>6&&(h.imageHead=l.call(v,0,S)),p(h)},m,"readAsArrayBuffer")||p(h)}return c=c||{},r.Promise&&typeof s!="function"?(c=s||{},h=c,new Promise(u)):(h=h||{},u(s,s))}function g(i,s,c){return!i||!s||!c?null:new Blob([c,t.call(i,s.byteLength)],{type:"image/jpeg"})}function e(i,s,c){var h={maxMetaDataSize:1024,disableMetaDataParsers:!0};if(!c&&r.Promise)return d(i,h).then(function(x){return g(i,x.imageHead,s)});d(i,function(x){c(g(i,x.imageHead,s))},h)}n.transform=function(i,s,c,h,x){n.requiresMetaData(s)?(x=x||{},d(h,function(u){u!==x&&(r.console&&console.log(u),u=x),o.call(n,i,s,c,h,u)},s,x)):o.apply(n,arguments)},n.blobSlice=t,n.bufferSlice=l,n.replaceHead=e,n.parseMetaData=d,n.metaDataParsers=f})})(ge);var q=ge.exports;O(q);var pe={exports:{}};(function(a){(function(n){a.exports?n(F):n(window.loadImage)})(function(n){var r=n.global;r.fetch&&r.Request&&r.Response&&r.Response.prototype.blob?n.fetchBlob=function(o,t,l){function f(d){return d.blob()}if(r.Promise&&typeof t!="function")return fetch(new Request(o,t)).then(f);fetch(new Request(o,l)).then(f).then(t).catch(function(d){t(null,d)})}:r.XMLHttpRequest&&new XMLHttpRequest().responseType===""&&(n.fetchBlob=function(o,t,l){function f(d,g){l=l||{};var e=new XMLHttpRequest;e.open(l.method||"GET",o),l.headers&&Object.keys(l.headers).forEach(function(i){e.setRequestHeader(i,l.headers[i])}),e.withCredentials=l.credentials==="include",e.responseType="blob",e.onload=function(){d(e.response)},e.onerror=e.onabort=e.ontimeout=function(i){d===g?g(null,i):g(i)},e.send(l.body)}return r.Promise&&typeof t!="function"?(l=t,new Promise(f)):f(t,t)})})})(pe);var Ne=pe.exports;O(Ne);var me={exports:{}};(function(a){(function(n){a.exports?n(F,q):n(window.loadImage)})(function(n){function r(e){e&&(Object.defineProperty(this,"map",{value:this.ifds[e].map}),Object.defineProperty(this,"tags",{value:this.tags&&this.tags[e]||{}}))}r.prototype.map={Orientation:274,Thumbnail:"ifd1",Blob:513,Exif:34665,GPSInfo:34853,Interoperability:40965},r.prototype.ifds={ifd1:{name:"Thumbnail",map:r.prototype.map},34665:{name:"Exif",map:{}},34853:{name:"GPSInfo",map:{}},40965:{name:"Interoperability",map:{}}},r.prototype.get=function(e){return this[e]||this[this.map[e]]};function o(e,i,s){if(s){if(i+s>e.byteLength){console.log("Invalid Exif data: Invalid thumbnail data.");return}return new Blob([n.bufferSlice.call(e.buffer,i,i+s)],{type:"image/jpeg"})}}var t={1:{getValue:function(e,i){return e.getUint8(i)},size:1},2:{getValue:function(e,i){return String.fromCharCode(e.getUint8(i))},size:1,ascii:!0},3:{getValue:function(e,i,s){return e.getUint16(i,s)},size:2},4:{getValue:function(e,i,s){return e.getUint32(i,s)},size:4},5:{getValue:function(e,i,s){return e.getUint32(i,s)/e.getUint32(i+4,s)},size:8},9:{getValue:function(e,i,s){return e.getInt32(i,s)},size:4},10:{getValue:function(e,i,s){return e.getInt32(i,s)/e.getInt32(i+4,s)},size:8}};t[7]=t[1];function l(e,i,s,c,h,x){var u=t[c],p,m,w,v,b,y;if(!u){console.log("Invalid Exif data: Invalid tag type.");return}if(p=u.size*h,m=p>4?i+e.getUint32(s+8,x):s+8,m+p>e.byteLength){console.log("Invalid Exif data: Invalid data offset.");return}if(h===1)return u.getValue(e,m,x);for(w=[],v=0;v<h;v+=1)w[v]=u.getValue(e,m+v*u.size,x);if(u.ascii){for(b="",v=0;v<w.length&&(y=w[v],y!=="\0");v+=1)b+=y;return b}return w}function f(e,i,s){return(!e||e[s])&&(!i||i[s]!==!0)}function d(e,i,s,c,h,x,u,p){var m,w,v,b,y,A;if(s+6>e.byteLength){console.log("Invalid Exif data: Invalid directory offset.");return}if(m=e.getUint16(s,c),w=s+2+12*m,w+4>e.byteLength){console.log("Invalid Exif data: Invalid directory size.");return}for(v=0;v<m;v+=1)b=s+2+12*v,y=e.getUint16(b,c),f(u,p,y)&&(A=l(e,i,b,e.getUint16(b+2,c),e.getUint32(b+4,c),c),h[y]=A,x&&(x[y]=b));return e.getUint32(w,c)}function g(e,i,s,c,h,x,u){var p=e.exif[i];p&&(e.exif[i]=new r(i),e.exifOffsets&&(e.exifOffsets[i]=new r(i)),d(s,c,c+p,h,e.exif[i],e.exifOffsets&&e.exifOffsets[i],x&&x[i],u&&u[i]))}n.parseExifData=function(e,i,s,c,h){if(!h.disableExif){var x=h.includeExifTags,u=h.excludeExifTags||{34665:{37500:!0}},p=i+10,m,w,v;if(e.getUint32(i+4)===1165519206){if(p+8>e.byteLength){console.log("Invalid Exif data: Invalid segment size.");return}if(e.getUint16(i+8)!==0){console.log("Invalid Exif data: Missing byte alignment offset.");return}switch(e.getUint16(p)){case 18761:m=!0;break;case 19789:m=!1;break;default:console.log("Invalid Exif data: Invalid byte alignment marker.");return}if(e.getUint16(p+2,m)!==42){console.log("Invalid Exif data: Missing TIFF marker.");return}w=e.getUint32(p+4,m),c.exif=new r,h.disableExifOffsets||(c.exifOffsets=new r,c.exifTiffOffset=p,c.exifLittleEndian=m),w=d(e,p,p+w,m,c.exif,c.exifOffsets,x,u),w&&f(x,u,"ifd1")&&(c.exif.ifd1=w,c.exifOffsets&&(c.exifOffsets.ifd1=p+w)),Object.keys(c.exif.ifds).forEach(function(b){g(c,b,e,p,m,x,u)}),v=c.exif.ifd1,v&&v[513]&&(v[513]=o(e,p+v[513],v[514]))}}},n.metaDataParsers.jpeg[65505].push(n.parseExifData),n.exifWriters={274:function(e,i,s){var c=i.exifOffsets[274];if(!c)return e;var h=new DataView(e,c+8,2);return h.setUint16(0,s,i.exifLittleEndian),e}},n.writeExifData=function(e,i,s,c){return n.exifWriters[i.exif.map[s]](e,i,c)},n.ExifMap=r})})(me);var xe=me.exports;O(xe);var ve={exports:{}};(function(a){(function(n){a.exports?n(F,xe):n(window.loadImage)})(function(n){var r=n.ExifMap.prototype;r.tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",34665:{36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",36880:"OffsetTime",36881:"OffsetTimeOriginal",36882:"OffsetTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber"},34853:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},40965:{1:"InteroperabilityIndex"}},r.tags.ifd1=r.tags,r.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"Original",2:"Horizontal flip",3:"Rotate 180° CCW",4:"Vertical flip",5:"Vertical flip + Rotate 90° CW",6:"Rotate 90° CW",7:"Horizontal flip + Rotate 90° CW",8:"Rotate 90° CCW"}},r.getText=function(o){var t=this.get(o);switch(o){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[o][t];case"ExifVersion":case"FlashpixVersion":return t?String.fromCharCode(t[0],t[1],t[2],t[3]):void 0;case"ComponentsConfiguration":return t?this.stringValues[o][t[0]]+this.stringValues[o][t[1]]+this.stringValues[o][t[2]]+this.stringValues[o][t[3]]:void 0;case"GPSVersionID":return t?t[0]+"."+t[1]+"."+t[2]+"."+t[3]:void 0}return String(t)},r.getAll=function(){var o={},t,l,f;for(t in this)Object.prototype.hasOwnProperty.call(this,t)&&(l=this[t],l&&l.getAll?o[this.ifds[t].name]=l.getAll():(f=this.tags[t],f&&(o[f]=this.getText(f))));return o},r.getName=function(o){var t=this.tags[o];return typeof t=="object"?this.ifds[o].name:t},function(){var o=r.tags,t,l,f;for(t in o)if(Object.prototype.hasOwnProperty.call(o,t))if(l=r.ifds[t],l){f=o[t];for(t in f)Object.prototype.hasOwnProperty.call(f,t)&&(l.map[f[t]]=Number(t))}else r.map[o[t]]=Number(t)}()})})(ve);var _e=ve.exports;O(_e);var ye={exports:{}};(function(a){(function(n){a.exports?n(F,q):n(window.loadImage)})(function(n){function r(){}r.prototype.map={ObjectName:5},r.prototype.types={0:"Uint16",200:"Uint16",201:"Uint16",202:"binary"},r.prototype.get=function(e){return this[e]||this[this.map[e]]};function o(e,i,s){for(var c="",h=i+s,x=i;x<h;x+=1)c+=String.fromCharCode(e.getUint8(x));return c}function t(e,i,s,c,h){return i.types[e]==="binary"?new Blob([s.buffer.slice(c,c+h)]):i.types[e]==="Uint16"?s.getUint16(c):o(s,c,h)}function l(e,i){return e===void 0?i:e instanceof Array?(e.push(i),e):[e,i]}function f(e,i,s,c,h,x){for(var u,p,m,w=i+s,v=i;v<w;)e.getUint8(v)===28&&e.getUint8(v+1)===2&&(m=e.getUint8(v+2),(!h||h[m])&&(!x||!x[m])&&(p=e.getInt16(v+3),u=t(m,c.iptc,e,v+5,p),c.iptc[m]=l(c.iptc[m],u),c.iptcOffsets&&(c.iptcOffsets[m]=v))),v+=1}function d(e,i){return e.getUint32(i)===943868237&&e.getUint16(i+4)===1028}function g(e,i){var s=e.getUint8(i+7);return s%2!==0&&(s+=1),s===0&&(s=4),s}n.parseIptcData=function(e,i,s,c,h){if(!h.disableIptc)for(var x=i+s;i+8<x;){if(d(e,i)){var u=g(e,i),p=i+8+u;if(p>x){console.log("Invalid IPTC data: Invalid segment offset.");break}var m=e.getUint16(i+6+u);if(i+m>x){console.log("Invalid IPTC data: Invalid segment size.");break}c.iptc=new r,h.disableIptcOffsets||(c.iptcOffsets=new r),f(e,p,m,c,h.includeIptcTags,h.excludeIptcTags||{202:!0});return}i+=1}},n.metaDataParsers.jpeg[65517].push(n.parseIptcData),n.IptcMap=r})})(ye);var we=ye.exports;O(we);var be={exports:{}};(function(a){(function(n){a.exports?n(F,we):n(window.loadImage)})(function(n){var r=n.IptcMap.prototype;r.tags={0:"ApplicationRecordVersion",3:"ObjectTypeReference",4:"ObjectAttributeReference",5:"ObjectName",7:"EditStatus",8:"EditorialUpdate",10:"Urgency",12:"SubjectReference",15:"Category",20:"SupplementalCategories",22:"FixtureIdentifier",25:"Keywords",26:"ContentLocationCode",27:"ContentLocationName",30:"ReleaseDate",35:"ReleaseTime",37:"ExpirationDate",38:"ExpirationTime",40:"SpecialInstructions",42:"ActionAdvised",45:"ReferenceService",47:"ReferenceDate",50:"ReferenceNumber",55:"DateCreated",60:"TimeCreated",62:"DigitalCreationDate",63:"DigitalCreationTime",65:"OriginatingProgram",70:"ProgramVersion",75:"ObjectCycle",80:"Byline",85:"BylineTitle",90:"City",92:"Sublocation",95:"State",100:"CountryCode",101:"Country",103:"OriginalTransmissionReference",105:"Headline",110:"Credit",115:"Source",116:"CopyrightNotice",118:"Contact",120:"Caption",121:"LocalCaption",122:"Writer",125:"RasterizedCaption",130:"ImageType",131:"ImageOrientation",135:"LanguageIdentifier",150:"AudioType",151:"AudioSamplingRate",152:"AudioSamplingResolution",153:"AudioDuration",154:"AudioOutcue",184:"JobID",185:"MasterDocumentID",186:"ShortDocumentID",187:"UniqueDocumentID",188:"OwnerID",200:"ObjectPreviewFileFormat",201:"ObjectPreviewFileVersion",202:"ObjectPreviewData",221:"Prefs",225:"ClassifyState",228:"SimilarityIndex",230:"DocumentNotes",231:"DocumentHistory",232:"ExifCameraInfo",255:"CatalogSets"},r.stringValues={10:{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"},75:{a:"Morning",b:"Both Morning and Evening",p:"Evening"},131:{L:"Landscape",P:"Portrait",S:"Square"}},r.getText=function(o){var t=this.get(o),l=this.map[o],f=this.stringValues[l];return f?f[t]:String(t)},r.getAll=function(){var o={},t,l;for(t in this)Object.prototype.hasOwnProperty.call(this,t)&&(l=this.tags[t],l&&(o[l]=this.getText(l)));return o},r.getName=function(o){return this.tags[o]},function(){var o=r.tags,t=r.map||{},l;for(l in o)Object.prototype.hasOwnProperty.call(o,l)&&(t[o[l]]=Number(l))}()})})(be);var We=be.exports;O(We);var Ce={exports:{}};(function(a){(function(n){a.exports?n(F,fe,q):n(window.loadImage)})(function(n){var r=n.transform,o=n.requiresCanvas,t=n.requiresMetaData,l=n.transformCoordinates,f=n.getTransformedOptions;(function(i){if(i.global.document){var s="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/xABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAAAAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQvoP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXwH/9k=",c=document.createElement("img");c.onload=function(){if(i.orientation=c.width===2&&c.height===3,i.orientation){var h=i.createCanvas(1,1,!0),x=h.getContext("2d");x.drawImage(c,1,1,1,1,0,0,1,1),i.orientationCropBug=x.getImageData(0,0,1,1).data.toString()!=="255,255,255,255"}},c.src=s}})(n);function d(i,s){var c=i&&i.orientation;return c===!0&&!n.orientation||c===1&&n.orientation||(!s||n.orientation)&&c>1&&c<9}function g(i,s){return i!==s&&(i===1&&s>1&&s<9||i>1&&i<9)}function e(i,s){if(s>1&&s<9)switch(i){case 2:case 4:return s>4;case 5:case 7:return s%2===0;case 6:case 8:return s===2||s===4||s===5||s===7}return!1}n.requiresCanvas=function(i){return d(i)||o.call(n,i)},n.requiresMetaData=function(i){return d(i,!0)||t.call(n,i)},n.transform=function(i,s,c,h,x){r.call(n,i,s,function(u,p){if(p){var m=n.orientation&&p.exif&&p.exif.get("Orientation");if(m>4&&m<9){var w=p.originalWidth,v=p.originalHeight;p.originalWidth=v,p.originalHeight=w}}c(u,p)},h,x)},n.getTransformedOptions=function(i,s,c){var h=f.call(n,i,s),x=c.exif&&c.exif.get("Orientation"),u=h.orientation,p=n.orientation&&x;if(u===!0&&(u=x),!g(u,p))return h;var m=h.top,w=h.right,v=h.bottom,b=h.left,y={};for(var A in h)Object.prototype.hasOwnProperty.call(h,A)&&(y[A]=h[A]);if(y.orientation=u,(u>4&&!(p>4)||u<5&&p>4)&&(y.maxWidth=h.maxHeight,y.maxHeight=h.maxWidth,y.minWidth=h.minHeight,y.minHeight=h.minWidth,y.sourceWidth=h.sourceHeight,y.sourceHeight=h.sourceWidth),p>1){switch(p){case 2:w=h.left,b=h.right;break;case 3:m=h.bottom,w=h.left,v=h.top,b=h.right;break;case 4:m=h.bottom,v=h.top;break;case 5:m=h.left,w=h.bottom,v=h.right,b=h.top;break;case 6:m=h.left,w=h.top,v=h.right,b=h.bottom;break;case 7:m=h.right,w=h.top,v=h.left,b=h.bottom;break;case 8:m=h.right,w=h.bottom,v=h.left,b=h.top;break}if(e(u,p)){var S=m,E=w;m=v,w=b,v=S,b=E}}switch(y.top=m,y.right=w,y.bottom=v,y.left=b,u){case 2:y.right=b,y.left=w;break;case 3:y.top=v,y.right=b,y.bottom=m,y.left=w;break;case 4:y.top=v,y.bottom=m;break;case 5:y.top=b,y.right=v,y.bottom=w,y.left=m;break;case 6:y.top=w,y.right=v,y.bottom=b,y.left=m;break;case 7:y.top=w,y.right=m,y.bottom=b,y.left=v;break;case 8:y.top=b,y.right=m,y.bottom=w,y.left=v;break}return y},n.transformCoordinates=function(i,s,c){l.call(n,i,s,c);var h=s.orientation,x=n.orientation&&c.exif&&c.exif.get("Orientation");if(g(h,x)){var u=i.getContext("2d"),p=i.width,m=i.height,w=p,v=m;switch((h>4&&!(x>4)||h<5&&x>4)&&(i.width=m,i.height=p),h>4&&(w=m,v=p),x){case 2:u.translate(w,0),u.scale(-1,1);break;case 3:u.translate(w,v),u.rotate(Math.PI);break;case 4:u.translate(0,v),u.scale(1,-1);break;case 5:u.rotate(-.5*Math.PI),u.scale(-1,1);break;case 6:u.rotate(-.5*Math.PI),u.translate(-w,0);break;case 7:u.rotate(-.5*Math.PI),u.translate(-w,v),u.scale(1,-1);break;case 8:u.rotate(.5*Math.PI),u.translate(0,-v);break}switch(e(h,x)&&(u.translate(w,v),u.rotate(Math.PI)),h){case 2:u.translate(p,0),u.scale(-1,1);break;case 3:u.translate(p,m),u.rotate(Math.PI);break;case 4:u.translate(0,m),u.scale(1,-1);break;case 5:u.rotate(.5*Math.PI),u.scale(1,-1);break;case 6:u.rotate(.5*Math.PI),u.translate(0,-m);break;case 7:u.rotate(.5*Math.PI),u.translate(p,-m),u.scale(-1,1);break;case 8:u.rotate(-.5*Math.PI),u.translate(-p,0);break}}}})})(Ce);var ze=Ce.exports;O(ze);var Ye=F;const Xe=O(Ye);function Ke(a,n,r,o){function t(l){return l instanceof r?l:new r(function(f){f(l)})}return new(r||(r=Promise))(function(l,f){function d(i){try{e(o.next(i))}catch(s){f(s)}}function g(i){try{e(o.throw(i))}catch(s){f(s)}}function e(i){i.done?l(i.value):t(i.value).then(d,g)}e((o=o.apply(a,n||[])).next())})}function qe(a,n){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},o,t,l,f;return f={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function d(e){return function(i){return g([e,i])}}function g(e){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,t&&(l=e[0]&2?t.return:e[0]?t.throw||((l=t.return)&&l.call(t),0):t.next)&&!(l=l.call(t,e[1])).done)return l;switch(t=0,l&&(e=[e[0]&2,l.value]),e[0]){case 0:case 1:l=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++,t=e[1],e=[0];continue;case 7:e=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!l||e[1]>l[0]&&e[1]<l[3])){r.label=e[1];break}if(e[0]===6&&r.label<l[1]){r.label=l[1],l=e;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(e);break}l[2]&&r.ops.pop(),r.trys.pop();continue}e=n.call(a,r)}catch(i){e=[6,i],t=0}finally{o=l=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}var Ae=function(){var a=R(),n=a[0],r=a[1],o=R(!1),t=o[0],l=o[1],f=R(),d=f[0],g=f[1],e=De(function(i,s,c){return Ke(void 0,void 0,void 0,function(){return qe(this,function(h){return[2,new Promise(function(x,u){l(!0),r(void 0);var p=je(i,s,c);p.on("state_changed",function(m){g(m)},function(m){l(!1),r(m),x(void 0)},function(){l(!1),g(void 0),x({metadata:p.snapshot.metadata,ref:p.snapshot.ref})})})]})})},[]);return[e,t,d,n]};function Ve(a){return ae({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M48.5 224H40c-13.3 0-24-10.7-24-24V72c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2L98.6 96.6c87.6-86.5 228.7-86.2 315.8 1c87.5 87.5 87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3c-62.2-62.2-162.7-62.5-225.3-1L185 183c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8H48.5z"}}]})(a)}function $e(a){return ae({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M463.5 224H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1c-87.5 87.5-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5z"}}]})(a)}const Y={x:0,y:0,width:0,height:0,unit:"px"};function W(a,n,r){return Math.min(Math.max(a,n),r)}function ee(a,n){return a.width===n.width&&a.height===n.height&&a.x===n.x&&a.y===n.y&&a.unit===n.unit}function U(a,n,r){return a.unit==="%"?{...Y,...a,unit:"%"}:{unit:"%",x:a.x?a.x/n*100:0,y:a.y?a.y/r*100:0,width:a.width?a.width/n*100:0,height:a.height?a.height/r*100:0}}function L(a,n,r){return a.unit?a.unit==="px"?{...Y,...a,unit:"px"}:{unit:"px",x:a.x?a.x*n/100:0,y:a.y?a.y*r/100:0,width:a.width?a.width*n/100:0,height:a.height?a.height*r/100:0}:{...Y,...a,unit:"px"}}function te(a,n,r,o,t,l=0,f=0,d=o,g=t){const e={...a};let i=Math.min(l,o),s=Math.min(f,t),c=Math.min(d,o),h=Math.min(g,t);n&&(n>1?(i=f?f*n:i,s=i/n,c=d*n):(s=l?l/n:s,i=s*n,h=g/n)),e.y<0&&(e.height=Math.max(e.height+e.y,s),e.y=0),e.x<0&&(e.width=Math.max(e.width+e.x,i),e.x=0);const x=o-(e.x+e.width);x<0&&(e.x=Math.min(e.x,o-i),e.width+=x);const u=t-(e.y+e.height);if(u<0&&(e.y=Math.min(e.y,t-s),e.height+=u),e.width<i&&((r==="sw"||r=="nw")&&(e.x-=i-e.width),e.width=i),e.height<s&&((r==="nw"||r=="ne")&&(e.y-=s-e.height),e.height=s),e.width>c&&((r==="sw"||r=="nw")&&(e.x-=c-e.width),e.width=c),e.height>h&&((r==="nw"||r=="ne")&&(e.y-=h-e.height),e.height=h),n){const p=e.width/e.height;if(p<n){const m=Math.max(e.width/n,s);(r==="nw"||r=="ne")&&(e.y-=m-e.height),e.height=m}else if(p>n){const m=Math.max(e.height*n,i);(r==="sw"||r=="nw")&&(e.x-=m-e.width),e.width=m}}return e}function Je(a,n,r,o){const t={...a};return n==="ArrowLeft"?o==="nw"?(t.x-=r,t.y-=r,t.width+=r,t.height+=r):o==="w"?(t.x-=r,t.width+=r):o==="sw"?(t.x-=r,t.width+=r,t.height+=r):o==="ne"?(t.y+=r,t.width-=r,t.height-=r):o==="e"?t.width-=r:o==="se"&&(t.width-=r,t.height-=r):n==="ArrowRight"&&(o==="nw"?(t.x+=r,t.y+=r,t.width-=r,t.height-=r):o==="w"?(t.x+=r,t.width-=r):o==="sw"?(t.x+=r,t.width-=r,t.height-=r):o==="ne"?(t.y-=r,t.width+=r,t.height+=r):o==="e"?t.width+=r:o==="se"&&(t.width+=r,t.height+=r)),n==="ArrowUp"?o==="nw"?(t.x-=r,t.y-=r,t.width+=r,t.height+=r):o==="n"?(t.y-=r,t.height+=r):o==="ne"?(t.y-=r,t.width+=r,t.height+=r):o==="sw"?(t.x+=r,t.width-=r,t.height-=r):o==="s"?t.height-=r:o==="se"&&(t.width-=r,t.height-=r):n==="ArrowDown"&&(o==="nw"?(t.x+=r,t.y+=r,t.width-=r,t.height-=r):o==="n"?(t.y+=r,t.height-=r):o==="ne"?(t.y+=r,t.width-=r,t.height-=r):o==="sw"?(t.x-=r,t.width+=r,t.height+=r):o==="s"?t.height+=r:o==="se"&&(t.width+=r,t.height+=r)),t}function Se(a){var n,r,o="";if(typeof a=="string"||typeof a=="number")o+=a;else if(typeof a=="object")if(Array.isArray(a))for(n=0;n<a.length;n++)a[n]&&(r=Se(a[n]))&&(o&&(o+=" "),o+=r);else for(n in a)a[n]&&(o&&(o+=" "),o+=n);return o}function Ze(){for(var a,n,r=0,o="";r<arguments.length;)(a=arguments[r++])&&(n=Se(a))&&(o&&(o+=" "),o+=n);return o}const j={capture:!0,passive:!1},I=class extends Ee{constructor(){super(...arguments),this.docMoveBound=!1,this.mouseDownOnCrop=!1,this.dragStarted=!1,this.evData={startClientX:0,startClientY:0,startCropX:0,startCropY:0,clientX:0,clientY:0,isResize:!0},this.componentRef=J(),this.mediaRef=J(),this.initChangeCalled=!1,this.state={cropIsActive:!1,newCropIsBeingDrawn:!1},this.onCropPointerDown=a=>{const{crop:n,disabled:r}=this.props,o=this.getBox();if(!n)return;const t=L(n,o.width,o.height);if(r)return;a.cancelable&&a.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const l=a.target.dataset.ord,f=!!l;let d=a.clientX,g=a.clientY,e=t.x,i=t.y;if(l){const s=a.clientX-o.x,c=a.clientY-o.y;let h=0,x=0;l==="ne"||l=="e"?(h=s-(t.x+t.width),x=c-t.y,e=t.x,i=t.y+t.height):l==="se"||l==="s"?(h=s-(t.x+t.width),x=c-(t.y+t.height),e=t.x,i=t.y):l==="sw"||l=="w"?(h=s-t.x,x=c-(t.y+t.height),e=t.x+t.width,i=t.y):(l==="nw"||l=="n")&&(h=s-t.x,x=c-t.y,e=t.x+t.width,i=t.y+t.height),d=e+o.x+h,g=i+o.y+x}this.evData={startClientX:d,startClientY:g,startCropX:e,startCropY:i,clientX:a.clientX,clientY:a.clientY,isResize:f,ord:l},this.mouseDownOnCrop=!0,this.setState({cropIsActive:!0})},this.onComponentPointerDown=a=>{const{crop:n,disabled:r,locked:o,keepSelection:t,onChange:l}=this.props,f=this.getBox();if(r||o||t&&n)return;a.cancelable&&a.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const d=a.clientX-f.x,g=a.clientY-f.y,e={unit:"px",x:d,y:g,width:0,height:0};this.evData={startClientX:a.clientX,startClientY:a.clientY,startCropX:d,startCropY:g,clientX:a.clientX,clientY:a.clientY,isResize:!0},this.mouseDownOnCrop=!0,l(L(e,f.width,f.height),U(e,f.width,f.height)),this.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})},this.onDocPointerMove=a=>{const{crop:n,disabled:r,onChange:o,onDragStart:t}=this.props,l=this.getBox();if(r||!n||!this.mouseDownOnCrop)return;a.cancelable&&a.preventDefault(),this.dragStarted||(this.dragStarted=!0,t&&t(a));const{evData:f}=this;f.clientX=a.clientX,f.clientY=a.clientY;let d;f.isResize?d=this.resizeCrop():d=this.dragCrop(),ee(n,d)||o(L(d,l.width,l.height),U(d,l.width,l.height))},this.onComponentKeyDown=a=>{const{crop:n,disabled:r,onChange:o,onComplete:t}=this.props,l=this.getBox();if(r)return;const f=a.key;let d=!1;if(!n)return;const g=this.makePixelCrop(),e=(navigator.platform.match("Mac")?a.metaKey:a.ctrlKey)?I.nudgeStepLarge:a.shiftKey?I.nudgeStepMedium:I.nudgeStep;if(f==="ArrowLeft"?(g.x-=e,d=!0):f==="ArrowRight"?(g.x+=e,d=!0):f==="ArrowUp"?(g.y-=e,d=!0):f==="ArrowDown"&&(g.y+=e,d=!0),d){a.cancelable&&a.preventDefault(),g.x=W(g.x,0,l.width-g.width),g.y=W(g.y,0,l.height-g.height);const i=L(g,l.width,l.height),s=U(g,l.width,l.height);o(i,s),t&&t(i,s)}},this.onHandlerKeyDown=(a,n)=>{const{aspect:r=0,crop:o,disabled:t,minWidth:l=0,minHeight:f=0,maxWidth:d,maxHeight:g,onChange:e,onComplete:i}=this.props,s=this.getBox();if(t||!o)return;if(a.key==="ArrowUp"||a.key==="ArrowDown"||a.key==="ArrowLeft"||a.key==="ArrowRight")a.stopPropagation(),a.preventDefault();else return;const c=(navigator.platform.match("Mac")?a.metaKey:a.ctrlKey)?I.nudgeStepLarge:a.shiftKey?I.nudgeStepMedium:I.nudgeStep,h=L(o,s.width,s.height),x=Je(h,a.key,c,n),u=te(x,r,n,s.width,s.height,l,f,d,g);if(!ee(o,u)){const p=U(u,s.width,s.height);e(u,p),i&&i(u,p)}},this.onDocPointerDone=a=>{const{crop:n,disabled:r,onComplete:o,onDragEnd:t}=this.props,l=this.getBox();this.unbindDocMove(),!(r||!n)&&this.mouseDownOnCrop&&(this.mouseDownOnCrop=!1,this.dragStarted=!1,t&&t(a),o&&o(L(n,l.width,l.height),U(n,l.width,l.height)),this.setState({cropIsActive:!1,newCropIsBeingDrawn:!1}))},this.onDragFocus=a=>{var n;(n=this.componentRef.current)==null||n.scrollTo(0,0)}}get document(){return document}getBox(){const a=this.mediaRef.current;if(!a)return{x:0,y:0,width:0,height:0};const{x:n,y:r,width:o,height:t}=a.getBoundingClientRect();return{x:n,y:r,width:o,height:t}}componentDidUpdate(a){const{crop:n,onComplete:r}=this.props;if(r&&!a.crop&&n){const{width:o,height:t}=this.getBox();o&&t&&r(L(n,o,t),U(n,o,t))}}componentWillUnmount(){this.resizeObserver&&this.resizeObserver.disconnect()}bindDocMove(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,j),this.document.addEventListener("pointerup",this.onDocPointerDone,j),this.document.addEventListener("pointercancel",this.onDocPointerDone,j),this.docMoveBound=!0)}unbindDocMove(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,j),this.document.removeEventListener("pointerup",this.onDocPointerDone,j),this.document.removeEventListener("pointercancel",this.onDocPointerDone,j),this.docMoveBound=!1)}getCropStyle(){const{crop:a}=this.props;if(a)return{top:`${a.y}${a.unit}`,left:`${a.x}${a.unit}`,width:`${a.width}${a.unit}`,height:`${a.height}${a.unit}`}}dragCrop(){const{evData:a}=this,n=this.getBox(),r=this.makePixelCrop(),o=a.clientX-a.startClientX,t=a.clientY-a.startClientY;return r.x=W(a.startCropX+o,0,n.width-r.width),r.y=W(a.startCropY+t,0,n.height-r.height),r}getPointRegion(a){const{evData:n}=this,r=n.clientX-a.x,o=n.clientY-a.y<n.startCropY;return r<n.startCropX?o?"nw":"sw":o?"ne":"se"}resizeCrop(){const{evData:a}=this,n=this.getBox(),{aspect:r=0,minWidth:o=0,minHeight:t=0,maxWidth:l,maxHeight:f}=this.props,d=this.getPointRegion(n),g=this.makePixelCrop(),e=a.ord?a.ord:d,i=a.clientX-a.startClientX,s=a.clientY-a.startClientY,c={unit:"px",x:0,y:0,width:0,height:0};d==="ne"?(c.x=a.startCropX,c.width=i,r?(c.height=c.width/r,c.y=a.startCropY-c.height):(c.height=Math.abs(s),c.y=a.startCropY-c.height)):d==="se"?(c.x=a.startCropX,c.y=a.startCropY,c.width=i,r?c.height=c.width/r:c.height=s):d==="sw"?(c.x=a.startCropX+i,c.y=a.startCropY,c.width=Math.abs(i),r?c.height=c.width/r:c.height=s):d==="nw"&&(c.x=a.startCropX+i,c.width=Math.abs(i),r?(c.height=c.width/r,c.y=a.startCropY-c.height):(c.height=Math.abs(s),c.y=a.startCropY+s));const h=te(c,r,d,n.width,n.height,o,t,l,f);return r||I.xyOrds.indexOf(e)>-1?(g.x=h.x,g.y=h.y,g.width=h.width,g.height=h.height):I.xOrds.indexOf(e)>-1?(g.x=h.x,g.width=h.width):I.yOrds.indexOf(e)>-1&&(g.y=h.y,g.height=h.height),g}createCropSelection(){const{ariaLabels:a=I.defaultProps.ariaLabels,disabled:n,locked:r,renderSelectionAddon:o,ruleOfThirds:t,crop:l}=this.props,f=this.getCropStyle();if(l)return D.createElement("div",{style:f,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown,"aria-label":a.cropArea,tabIndex:0,onKeyDown:this.onComponentKeyDown,role:"group"},!n&&!r&&D.createElement("div",{className:"ReactCrop__drag-elements",onFocus:this.onDragFocus},D.createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),D.createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),D.createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),D.createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),D.createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw",tabIndex:0,"aria-label":a.nwDragHandle,onKeyDown:d=>this.onHandlerKeyDown(d,"nw"),role:"button"}),D.createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n",tabIndex:0,"aria-label":a.nDragHandle,onKeyDown:d=>this.onHandlerKeyDown(d,"n"),role:"button"}),D.createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne",tabIndex:0,"aria-label":a.neDragHandle,onKeyDown:d=>this.onHandlerKeyDown(d,"ne"),role:"button"}),D.createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e",tabIndex:0,"aria-label":a.eDragHandle,onKeyDown:d=>this.onHandlerKeyDown(d,"e"),role:"button"}),D.createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se",tabIndex:0,"aria-label":a.seDragHandle,onKeyDown:d=>this.onHandlerKeyDown(d,"se"),role:"button"}),D.createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s",tabIndex:0,"aria-label":a.sDragHandle,onKeyDown:d=>this.onHandlerKeyDown(d,"s"),role:"button"}),D.createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw",tabIndex:0,"aria-label":a.swDragHandle,onKeyDown:d=>this.onHandlerKeyDown(d,"sw"),role:"button"}),D.createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w",tabIndex:0,"aria-label":a.wDragHandle,onKeyDown:d=>this.onHandlerKeyDown(d,"w"),role:"button"})),o&&D.createElement("div",{className:"ReactCrop__selection-addon",onMouseDown:d=>d.stopPropagation()},o(this.state)),t&&D.createElement(D.Fragment,null,D.createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),D.createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}makePixelCrop(){const a={...Y,...this.props.crop||{}},n=this.getBox();return L(a,n.width,n.height)}render(){const{aspect:a,children:n,circularCrop:r,className:o,crop:t,disabled:l,locked:f,style:d,ruleOfThirds:g}=this.props,{cropIsActive:e,newCropIsBeingDrawn:i}=this.state,s=t?this.createCropSelection():null,c=Ze("ReactCrop",o,{"ReactCrop--active":e,"ReactCrop--disabled":l,"ReactCrop--locked":f,"ReactCrop--new-crop":i,"ReactCrop--fixed-aspect":t&&a,"ReactCrop--circular-crop":t&&r,"ReactCrop--rule-of-thirds":t&&g,"ReactCrop--invisible-crop":!this.dragStarted&&t&&!t.width&&!t.height,"ReactCrop--no-animate":r});return D.createElement("div",{ref:this.componentRef,className:c,style:d},D.createElement("div",{ref:this.mediaRef,className:"ReactCrop__child-wrapper",onPointerDown:this.onComponentPointerDown},n),s)}};let H=I;H.xOrds=["e","w"];H.yOrds=["n","s"];H.xyOrds=["nw","ne","se","sw"];H.nudgeStep=1;H.nudgeStepMedium=10;H.nudgeStepLarge=100;H.defaultProps={ariaLabels:{cropArea:"Use the arrow keys to move the crop selection area",nwDragHandle:"Use the arrow keys to move the north west drag handle to change the crop selection area",nDragHandle:"Use the up and down arrow keys to move the north drag handle to change the crop selection area",neDragHandle:"Use the arrow keys to move the north east drag handle to change the crop selection area",eDragHandle:"Use the up and down arrow keys to move the east drag handle to change the crop selection area",seDragHandle:"Use the arrow keys to move the south east drag handle to change the crop selection area",sDragHandle:"Use the up and down arrow keys to move the south drag handle to change the crop selection area",swDragHandle:"Use the arrow keys to move the south west drag handle to change the crop selection area",wDragHandle:"Use the up and down arrow keys to move the west drag handle to change the crop selection area"}};Re(".ReactCrop__crop-selection",{animationPlayState:"paused !important"});const re={unit:"%",x:0,y:0,width:100,height:100};function et(a){var p;const n=G(Q),[r,o]=R(((p=a.initialMeta)==null?void 0:p.crop)||re),[t,l]=R(a.initialMeta?a.initialMeta.rotation:void 0),[f,d]=R(!0),[g,e]=R(),i=z(null),[s,c,h,x]=Ae(),u=a.file.url;return X(()=>{Xe(u,m=>{const w=m.toDataURL("image/jpeg");e(w),f||o(re),d(!1)},{orientation:t===void 0?!0:Number.parseInt(Object.values(Me)[t+4]),canvas:!0,crossOrigin:"anonymous"})},[u,t||0]),C("div",{style:{display:"flex",alignItems:"center",flexDirection:"column"},children:[g&&C(H,{crop:r,onChange:(m,w)=>o(w),keepSelection:!0,children:C("img",{src:g,style:{maxHeight:400,maxWidth:"min(400px, 100%)"}})}),C("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem",marginTop:"1.5rem"},children:[C(T,{icon:C(Ve,{}),onClick:()=>l((((t||0)-1)%4+4)%4)}),C(T,{icon:C($e,{}),onClick:()=>l(((t||0)+1)%4)})]}),C("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem",marginTop:"1.5rem"},children:[C("canvas",{ref:i,style:{display:"none"}}),C(T,{icon:C(oe,{}),buttonType:"success",onClick:async()=>{if(r||t?a.setMeta({crop:r,rotation:t||0}):a.setMeta(void 0),!i.current||!g)return;const m=await tt(r,i.current,g);if(m){const w=M(n,"images/cropped/"+a.file.name);try{await s(w,m,{contentType:"image/jpeg"})}catch(v){console.error(v)}}},children:"Save"}),C(T,{icon:C(se,{}),buttonType:"destructive",onClick:()=>a.setMeta(void 0),children:"Cancel"})]})]})}async function tt(a,n,r){const o=new Image;o.src=r||"";const t=L(a,o.width,o.height),{x:l,y:f,width:d,height:g}=t;n.width=d,n.height=g;const e=n.getContext("2d");return e==null||e.drawImage(o,l,f,d,g,0,0,d,g),new Promise(i=>n.toBlob(i,"image/jpeg",.9))}const rt=K({display:"flex",flexDirection:"column",maxHeight:"90vh",width:"85vw",background:"var(--light)",position:"relative"},Ie({maxWidth:Be},{width:"100vw",height:"100dvh",maxHeight:"100dvh"})),nt=K({display:"flex",padding:"0.75rem",position:"absolute",right:"0.5rem",background:"none",border:"none",outlineColor:"var(--light)",outlineOffset:"-6px"});function it(a){const n=ke();return X(()=>{const r=o=>{o.key==="Escape"&&a.onClose()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),C("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100vw",height:"100dvh",position:"absolute",top:0,left:0,background:"rgba(0,0,0,0.5)",zIndex:10},onMouseDown:r=>{r.target===r.currentTarget&&(a.onClose(),r.stopPropagation(),r.preventDefault())},ref:n,children:C("div",{className:rt,children:[C("div",{style:{display:"flex",justifyContent:"center",position:"relative",background:"var(--dark)",color:"var(--light)",padding:"0.5rem"},children:[C("h3",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:a.title}),C("button",{onClick:()=>a.onClose(),className:nt,children:C(se,{})})]}),C("div",{style:{flex:1,overflowY:"auto",padding:"1rem"},children:a.children})]})})}const at=K({$nest:{"&::file-selector-button":{marginRight:"20px",padding:"0.5rem 1rem",background:"var(--cta)",border:"1px solid var(--cta-border)",borderRadius:"0.25rem",color:"white",cursor:"pointer",transition:"background .2s ease-in-out"},"&::file-selector-button:hover":{background:"var(--cta-hover)"}}});function ot(a){const n=G(Q),r=z(null),[o,t]=R([]),[l,f,d,g]=Ae();return C("div",{style:{display:"flex",justifyContent:"center"},children:C("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"1rem",margin:"1rem"},children:[C("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[C("input",{id:"file",type:"file",accept:"image/*",ref:r,onChange:e=>{t(Array.from(e.target.files||[]))},className:at,disabled:f,multiple:!0}),C(T,{icon:C(Oe,{}),disabled:f||o.length===0,style:{whiteSpace:"nowrap"},onClick:async()=>{for(const e of o){const i=M(n,"images/"+e.name);try{await l(i,e,{contentType:e.type,cacheControl:"public,max-age=31536000"})}catch(s){console.error(s)}}setTimeout(()=>{r.current&&(r.current.value=""),t([]),a.reloadFiles()},3e3)},children:["Upload Image",o.length>1&&"s"]})]}),f&&C(Fe,{})]})})}function st(a,n){const[r,o]=R([]),[t,l]=R(!0),f=G(Q),d=M(f,a);return X(()=>{l(!0),Qe(d).then(g=>{const e=[];for(const i of g.items){if(i.name.includes("16x16")||i.name.includes("200x200")||i.name.includes("400x400")||i.name.includes("1000x1000")||i.name.includes("2000x2000"))continue;const s=B(i.fullPath,k.Large,!0),c=B(i.fullPath,k.Medium,!0);e.push({name:i.name,path:i.fullPath,url:s,thumbnail:c,ref:i})}o(e),l(!1)})},[n]),[r,t]}function ct(a){if(a.fullPath.includes(".svg"))return[a];const n=G(Q);return[a,M(n,B(a.fullPath,k.Thumbnail)),M(n,B(a.fullPath,k.Thumbnail,!0)),M(n,B(a.fullPath,k.Medium)),M(n,B(a.fullPath,k.Medium,!0)),M(n,B(a.fullPath,k.Large)),M(n,B(a.fullPath,k.Large,!0)),M(n,B(a.fullPath,k.ExtraLarge)),M(n,B(a.fullPath,k.ExtraLarge,!0))]}const lt=K({width:"10rem",height:"10rem",padding:"0",marginBottom:"0.5rem",background:"transparent",border:"1px solid",borderRadius:"0.5rem",$nest:{"&:hover":{filter:"brightness(0.8)"},"& img":{width:"100%",height:"100%",objectFit:"cover",borderRadius:"0.5rem"}}});function ht(a){const{reloadCounter:n,setReloadCounter:r,multiDirty:o,setMultiDirty:t,setEditing:l}=a,f=z(null),[d,g]=st("images/",n),[e,i]=ce.use();if(!e)return null;const[s,c,h,x,u]=le(e.ref),[p,m]=R([]),{meta:w,getEditImageUrl:v}=Le(),b=G(Q);return X(()=>{if(!s||!e.multi){m([]);return}try{m(s)}catch(y){console.error(y),m([])}},[s]),C("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[C("div",{style:{borderBottom:"1px solid #bbb",width:"80%",margin:"0 0 1rem",textAlign:"center"}}),!g&&d.length>0&&e.multi&&C(T,{icon:C(oe,{}),buttonType:"success",onClick:()=>{x(p),i(void 0)},style:{margin:"0.75rem"},disabled:!o||u,children:"Save Selected Images"}),C("div",{ref:f,style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"1rem"},children:[g&&C("div",{children:"Loading Images..."}),!g&&d.length===0&&C("div",{children:"No Images Have Been Uploaded"}),!g&&d.map(y=>{const A=z(null);return C("div",{style:{display:"flex",flexDirection:"column"},children:[C("button",{className:lt,onClick:S=>{e.multi&&A.current?A.current.click():(x([{url:B(y.path,k.Large,!0),itemPath:y.ref.fullPath}]),i(void 0))},style:{position:"relative"},title:y.name,children:[e.multi&&C("input",{type:"checkbox",ref:A,onClick:S=>{S.stopPropagation(),t(!0),m(E=>S.target.checked?[...E,{url:y.url,thumbnail:y.thumbnail,itemPath:y.ref.fullPath}]:E.filter(P=>P.url!==y.url))},style:{position:"absolute",top:"0.25rem",right:"0.25rem"},"data-url":y.url,"data-thumbnail":y.thumbnail,"data-item-path":y.ref.fullPath,checked:p.some(S=>S.url===y.url)}),C("img",{src:v(y.path,y.thumbnail),loading:"lazy",onError:S=>setTimeout(()=>{S.target.src="",S.target.src=y.thumbnail},1500)})]}),C("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"center"},children:[C(T,{icon:C(Te,{}),onClick:()=>l(y),style:{padding:"0.35rem 1.25rem",height:"1.5rem"},title:"Edit Image"}),C(T,{icon:C(He,{}),buttonType:"destructive",onClick:async()=>{if(confirm("Are you sure you want to delete this image?")){const S=ct(y.ref);if(w&&w[V(y.path)]!==void 0){S.forEach(P=>{S.push(M(b,P.fullPath.replace("images/","images/cropped/")))});const E=ne(he,`${$}/${V(y.path)}`);ie(E)}await Promise.all(S.map(E=>Ge(E))),r(n+1)}},style:{padding:"0.35rem 1.25rem",height:"1.5rem"},title:"Delete Image"})]})]},y.url)})]})]})}function xt(){const[a,n]=ce.use(),[r,o]=R(0),[t,l]=R(!1),[f,d]=R(),[g,e,i,s,c]=le($),h=V((f==null?void 0:f.path)||"");return a?C(it,{title:C(Z,{children:[f?"Editing Image":a.multi?"Choose Multiple Images":"Choose an Image"," ",C(Ue,{})]}),onClose:()=>{t&&!confirm("Changes you have made may not be saved. Are you sure you want to exit?")||n(void 0)},children:f?C(et,{file:f,initialMeta:g&&g[h],setMeta:x=>{if(x)s({...g,[h]:x});else{const u=ne(he,`${$}/${h}`);ie(u)}d(void 0)}}):C(Z,{children:[C(ot,{reloadFiles:()=>o(()=>r+1)}),C(ht,{reloadCounter:r,multiDirty:t,setReloadCounter:o,setMultiDirty:l,setEditing:d,imageMeta:g})]})}):null}export{xt as FilePicker};
